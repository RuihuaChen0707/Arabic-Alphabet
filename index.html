<!DOCTYPE html>
<html lang="zh" dir="ltr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="阿拉伯语学习">
    <meta name="format-detection" content="telephone=no">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="theme-color" content="#667eea">
    <meta name="apple-touch-fullscreen" content="yes">
    <title>阿拉伯语学习路径</title>
    <link rel="stylesheet" href="style.css">
    <style>
        /* Safari兼容性样式 */
        * {
            -webkit-touch-callout: none;
            -webkit-user-select: none;
            -khtml-user-select: none;
            -moz-user-select: none;
            -ms-user-select: none;
            user-select: none;
        }

        /* Safari语音按钮样式修复 */
        .play-btn {
            -webkit-appearance: none;
            appearance: none;
            border: none;
            background: none;
            cursor: pointer;
        }
    </style>
</head>
<body>
    <div class="container">
        <header class="header">
            <h1>阿拉伯语学习路径</h1>
            <p class="subtitle">系统化学习阿拉伯语</p>
        </header>

        <!-- 学习路径区域 -->
        <div class="learning-path" id="learningPath">
            <div class="path-intro">
                <h2>学习旅程</h2>
                <p>按照以下路径循序渐进地学习阿拉伯语</p>
            </div>

            <div class="course-grid">
                <!-- 第一课：字母表 -->
                <div class="course-card available" onclick="goToLesson('alphabet')">
                    <div class="course-icon">📚</div>
                    <div class="course-info">
                        <h3>第一课 - 字母表</h3>
                        <p>学习28个阿拉伯语字母的发音和书写</p>
                        <div class="course-status">
                            <span class="status-badge available">可学习</span>
                            <span class="progress">基础入门</span>
                        </div>
                    </div>
                    <div class="course-arrow">→</div>
                </div>

                <!-- 第二课：认读单词闪卡 -->
                <div class="course-card available" onclick="goToLesson('flashcards')">
                    <div class="course-icon">🎴</div>
                    <div class="course-info">
                        <h3>第二课 - 认读单词闪卡</h3>
                        <p>通过闪卡学习基础阿拉伯语单词</p>
                        <div class="course-status">
                            <span class="status-badge available">可学习</span>
                            <span class="progress">词汇积累</span>
                        </div>
                    </div>
                    <div class="course-arrow">→</div>
                </div>

                <!-- 第三课：基础语法（未来开发） -->
                <div class="course-card locked">
                    <div class="course-icon">📝</div>
                    <div class="course-info">
                        <h3>第三课 - 基础语法</h3>
                        <p>学习阿拉伯语的基础语法规则</p>
                        <div class="course-status">
                            <span class="status-badge locked">即将推出</span>
                            <span class="progress">语法入门</span>
                        </div>
                    </div>
                    <div class="course-arrow">→</div>
                </div>

                <!-- 第四课：日常对话（未来开发） -->
                <div class="course-card locked">
                    <div class="course-icon">💬</div>
                    <div class="course-info">
                        <h3>第四课 - 日常对话</h3>
                        <p>掌握日常生活中的基础对话</p>
                        <div class="course-status">
                            <span class="status-badge locked">即将推出</span>
                            <span class="progress">实用对话</span>
                        </div>
                    </div>
                    <div class="course-arrow">→</div>
                </div>

                <!-- 第五课：阅读理解（未来开发） -->
                <div class="course-card locked">
                    <div class="course-icon">📖</div>
                    <div class="course-info">
                        <h3>第五课 - 阅读理解</h3>
                        <p>阅读简单的阿拉伯语文章和故事</p>
                        <div class="course-status">
                            <span class="status-badge locked">即将推出</span>
                            <span class="progress">阅读能力</span>
                        </div>
                    </div>
                    <div class="course-arrow">→</div>
                </div>

                <!-- 第六课：进阶学习（未来开发） -->
                <div class="course-card locked">
                    <div class="course-icon">🎓</div>
                    <div class="course-info">
                        <h3>第六课 - 进阶学习</h3>
                        <p>深入学习阿拉伯语的高级知识</p>
                        <div class="course-status">
                            <span class="status-badge locked">即将推出</span>
                            <span class="progress">高级应用</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- 学习统计区域 -->
        <div class="learning-stats">
            <h3>学习统计</h3>
            <div class="stats-grid">
                <div class="stat-item">
                    <div class="stat-number" id="completedLessons">1</div>
                    <div class="stat-label">已完成课程</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalWords">0</div>
                    <div class="stat-label">学习单词</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="studyTime">0</div>
                    <div class="stat-label">学习时间(分钟)</div>
                </div>
            </div>
        </div>

        <!-- 字母学习页面（第一课） -->
        <div class="alphabet-lesson" id="alphabetLesson" style="display: none;">
            <header class="lesson-header">
                <button class="back-btn" onclick="backToHome()">← 返回主页</button>
                <h2>第一课 - 阿拉伯语字母表</h2>
            </header>

            <!-- 字母卡片区域 -->
            <div class="alphabet-grid" id="alphabetGrid">
                <!-- 字母卡片将通过JavaScript动态生成 -->
            </div>

            <!-- 测试模式入口 -->
            <div class="test-section">
                <button class="test-button" onclick="enterTestMode()">进入测试模式</button>
            </div>
        </div>
    </div>

    <!-- 测试模式弹窗 -->
    <div class="test-modal" id="testModal">
        <div class="test-content">
            <h2>测试模式</h2>
            <div class="test-info">
                <p>题目 <span id="questionNumber">1</span>/10</p>
                <p>得分: <span id="score">0</span></p>
            </div>
            
            <!-- 题型1：显示字母，选择发音 -->
            <div class="question-type-1" id="questionType1">
                <div class="question-letter" id="questionLetter">ا</div>
                <div class="options" id="options1">
                    <!-- 选项将通过JavaScript生成 -->
                </div>
            </div>
            
            <!-- 题型2：显示发音，选择字母 -->
            <div class="question-type-2" id="questionType2" style="display: none;">
                <p style="font-size: 1.5rem; color: #667eea; margin-bottom: 20px;">请根据发音选择正确的字母</p>
                <button class="play-sound-btn" onclick="playSound()">播放发音</button>
                <div class="options" id="options2">
                    <!-- 选项将通过JavaScript生成 -->
                </div>
            </div>
            
            <div class="feedback" id="feedback"></div>
            
            <div class="test-buttons">
                <button onclick="closeTestMode()">退出测试</button>
                <button onclick="nextQuestion()" id="nextBtn" style="display: none;">下一题</button>
            </div>
        </div>
    </div>

    <!-- 字母学习模态框 -->
    <div class="learning-modal" id="learningModal">
        <div class="learning-content">
            <h2>字母学习</h2>
            <button class="close-btn" onclick="closeLearningMode()">&times;</button>
            
            <!-- 发音符号形式 -->
            <div class="pronunciation-forms">
                <h3>发音符号形式</h3>
                <div class="forms-grid">
                    <div class="form-item" onclick="playPronunciation('fatha')">
                        <div class="form-letter" id="fatha"></div>
                        <div class="form-label">开口符</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('kasra')">
                        <div class="form-letter" id="kasra"></div>
                        <div class="form-label">齐齿符</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('damma')">
                        <div class="form-letter" id="damma"></div>
                        <div class="form-label">合口符</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('fathaLong')">
                        <div class="form-letter" id="fathaLong"></div>
                        <div class="form-label">开口符长音</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('kasraLong')">
                        <div class="form-letter" id="kasraLong"></div>
                        <div class="form-label">齐齿符长音</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('dammaLong')">
                        <div class="form-letter" id="dammaLong"></div>
                        <div class="form-label">合口符长音</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('fathaNasal')">
                        <div class="form-letter" id="fathaNasal"></div>
                        <div class="form-label">开口符鼻音</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('kasraNasal')">
                        <div class="form-letter" id="kasraNasal"></div>
                        <div class="form-label">齐齿符鼻音</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('dammaNasal')">
                        <div class="form-letter" id="dammaNasal"></div>
                        <div class="form-label">合口符鼻音</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('softAy')">
                        <div class="form-letter" id="softAy"></div>
                        <div class="form-label">软音ay</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('softAw')">
                        <div class="form-letter" id="softAw"></div>
                        <div class="form-label">软音aw</div>
                        <button class="play-btn">🔊</button>
                    </div>
                </div>
            </div>

            <!-- 字母形式 -->
            <div class="letter-forms">
                <h3>字母形式</h3>
                <div class="forms-grid">
                    <div class="form-item" onclick="playPronunciation('isolated')">
                        <div class="form-letter" id="isolatedForm"></div>
                        <div class="form-label">独立形式</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('initial')">
                        <div class="form-letter" id="initialForm"></div>
                        <div class="form-label">开头形式</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('middle')">
                        <div class="form-letter" id="middleForm"></div>
                        <div class="form-label">中间形式</div>
                        <button class="play-btn">🔊</button>
                    </div>
                    <div class="form-item" onclick="playPronunciation('final')">
                        <div class="form-letter" id="finalForm"></div>
                        <div class="form-label">结尾形式</div>
                        <button class="play-btn">🔊</button>
                    </div>
                </div>
            </div>
            
            <!-- 手写白板区域 -->
            <div class="writing-area">
                <h3>手写练习</h3>
                <div class="canvas-container">
                    <canvas id="writingCanvas" width="400" height="200"></canvas>
                    <div class="canvas-lines"></div>
                </div>
                <div class="canvas-controls">
                    <button onclick="clearCanvas()" class="clear-btn">清屏</button>
                    <button onclick="toggleEraser()" class="eraser-btn">橡皮擦</button>
                    <button onclick="togglePencil()" class="pencil-btn active">铅笔</button>
                </div>
            </div>
        </div>
    </div>

    <!-- 单词闪卡页面（第二课） -->
    <div class="flashcards-page" id="flashcardsPage" style="display: none;">
        <div class="flashcards-container">
            <header class="flashcards-header">
                <button class="back-btn" onclick="backToHome()">← 返回主页</button>
                <h2>第二课 - 认读单词闪卡</h2>
                <div class="flashcards-progress">
                    <span id="currentWord">1</span> / <span id="totalWordsCount">20</span>
                </div>
            </header>

            <!-- 单词卡片区域 -->
            <div class="flashcard-area">
                <div class="flashcard" id="flashcard">
                    <div class="card-front" id="cardFront">
                        <div class="word-image-container">
                            <img id="wordImage" src="" alt="单词图片" style="display: none;">
                            <div class="image-loading" id="imageLoading">生成图片中...</div>
                        </div>
                        <div class="word-arabic" id="wordArabic"></div>
                        <button class="sound-btn" onclick="playWordSound()">🔊</button>
                    </div>
                    <div class="card-back" id="cardBack" style="display: none;">
                        <div class="word-romanization" id="wordRomanization"></div>
                        <div class="word-meaning" id="wordMeaning"></div>
                        <div class="word-usage" id="wordUsage"></div>
                    </div>
                </div>

                <div class="card-controls">
                    <button class="control-btn" onclick="previousWord()">← 上一个</button>
                    <button class="control-btn primary" onclick="flipCard()">翻转卡片</button>
                    <button class="control-btn" onclick="nextWord()">下一个 →</button>
                </div>
            </div>

            <!-- 学习控制区域 -->
            <div class="flashcards-controls">
                <div class="difficulty-buttons">
                    <button class="difficulty-btn" onclick="markDifficult()">困难</button>
                    <button class="difficulty-btn" onclick="markKnown()">已掌握</button>
                </div>
                <div class="study-modes">
                    <button class="mode-btn active" id="studyMode" onclick="setMode('study')">学习模式</button>
                    <button class="mode-btn" id="reviewMode" onclick="setMode('review')">复习模式</button>
                </div>
            </div>

            <!-- 进度统计 -->
            <div class="flashcards-stats">
                <div class="stat-bar">
                    <div class="progress-fill" id="progressFill"></div>
                </div>
                <div class="stats-info">
                    <span>已学习: <span id="learnedCount">0</span></span>
                    <span>已掌握: <span id="masteredCount">0</span></span>
                    <span>需复习: <span id="reviewCount">0</span></span>
                </div>
            </div>
        </div>
    </div>

    <script src="safari-polyfill.js"></script>
    <script src="script.js"></script>
</body>
</html>